"use strict";function initLocalClocks(){for(var e=new Date,n=e.getSeconds(),a=e.getMinutes(),t=e.getHours(),o=[{hand:"hours",angle:30*t+a/2},{hand:"minutes",angle:6*a},{hand:"seconds",angle:6*n}],r=0;r<o.length;r++)for(var i=document.querySelectorAll("."+o[r].hand),l=0;l<i.length;l++)i[l].style.webkitTransform="rotateZ("+o[r].angle+"deg)",i[l].style.transform="rotateZ("+o[r].angle+"deg)","minutes"===o[r].hand&&i[l].parentNode.setAttribute("data-second-angle",o[r+1].angle)}function moveSecondHands(){var e=document.querySelectorAll(".seconds-container");setInterval(function(){for(var n=0;n<e.length;n++)void 0===e[n].angle?e[n].angle=6:e[n].angle+=6,e[n].style.webkitTransform="rotateZ("+e[n].angle+"deg)",e[n].style.transform="rotateZ("+e[n].angle+"deg)"},1e3)}$("document").ready(function(){app.init(),initLocalClocks(),moveSecondHands()});var app={url:{login:"/login",review:"/get-reviews",bars:"/get-bars",logout:"/log-out",createbar:"/create-bar",createreview:"/create-review",editreview:"/edit-review",deletebar:"/delete-bar/:id",deletereview:"/delete-review"},user:"",id:"",init:function(){app.events(),app.styling()},loginSubmit:function(){event.preventDefault(),app.user=$("input[name=username]").val();var e=$("input[type=password]").val();if(console.log("shit submit",app.user),"poop"===e){var n={username:app.user};app.createUser(JSON.stringify(n)),$(".login").fadeOut(),$(".hoh-main").removeClass("hidden").hide().fadeIn(2e3)}else $("input[type=password]").val("").attr("placeholder","wrong password!")},barSubmit:function(){event.preventDefault();var e={barName:$("input[name=barName]").val(),barLocation:$("input[name=location]").val(),imageUrl:$("input[name=imageUrl]").val(),author:app.user};console.log("bar",e),app.createBar(JSON.stringify(e))},reviewSubmit:function(){event.preventDefault();var e={rating:$("select").val(),review:$("textarea").val(),author:app.user};console.log("review",e),app.createReview(JSON.stringify(e))},styling:function(){$(".welcome").text(app.user+", Welcome to The Secret Society of Happiness")},events:function(){$("button[name=button]").on("click",function(e){app.loginSubmit(),app.styling()}),$(".login").on("keypress click",function(e){var n=e.keyCode||e.which;return 13===n?(app.loginSubmit(),app.styling(),!1):void 0}),$(".bars").on("click",".summary",function(e){app.id=this.getAttribute("data-id"),console.log("bar id",app.id),$(".addReview").fadeIn().css({display:"flex"}),app.readBarFull(),app.readReview()}),$(".reviewIcon").on("click",function(){$(".reviewInput").slideToggle("slow",function(e){})}),$("button[name=reviewSubmit]").on("click",function(e){$(".reviewInput").slideToggle("slow",function(e){}),app.reviewSubmit(),$("textarea").val("")}),$(".plus").on("click",function(){$(".barInput").slideToggle("slow",function(e){})}),$("button[name=barSubmit]").on("click",function(e){$(".barInput").slideToggle("slow",function(e){}),app.barSubmit(),$("input").val("")}),$(".aboutIcon").on("click",function(){$(".addReview").hide(),$(".bars").html(""),$(".aboutPage").fadeIn()}),$(".barPage").on("click",function(){$(".addReview").hide(),$(".aboutPage").hide(),app.readBar()}),$(".bars").on("click","button[name=reviewDelete]",function(){var e=this.parentElement.getAttribute("data-id");console.log(e),app.deleteReview(Number(e))})},createUser:function(e){$.ajax({url:app.url.login,data:e,method:"POST",success:function(e){console.log("X gonna give it to ya::creatingUser",e),app.readBar()},error:function(e){console.log("dang son",e)}})},createBar:function(e){$.ajax({url:app.url.createbar,data:e,method:"POST",success:function(e){console.log("X gonna give it to ya::creatingBar",e),app.readBar()},error:function(e){console.log("dang son",e)}})},createReview:function(e){$.ajax({url:app.url.createreview,data:e,method:"POST",success:function(e){console.log("X gonna give it to ya::creatingBar",e),app.readReview()},error:function(e){console.log("dang son",e)}})},readBar:function(){$.ajax({url:app.url.bars,method:"GET",success:function(e){console.log("X gonna give it to ya::reading",e),e=JSON.parse(e),$(".bars").html(""),e.forEach(function(e,n){var a=app.htmlGen(templates.barSummary,e);$(".bars").append(a)})},error:function(e){console.log("dang son",e)}})},readBarFull:function(){$.ajax({url:app.url.bars,method:"GET",success:function(e){console.log("X gonna give it to ya::reading",e),e=JSON.parse(e),$(".bars").html("");var n=e.filter(function(e,n){return e.barId===Number(app.id)});console.log(n);var a=app.htmlGen(templates.barFullView,n[0]);$(".bars").append(a)},error:function(e){console.log("dang son",e)}})},readReview:function(){$.ajax({url:app.url.review,method:"GET",success:function(e){console.log("X gonna give it to ya::reading",e),e=JSON.parse(e);var n=app.htmlGen(templates.review,e[0]);$(".bars").append(n)},error:function(e){console.log("dang son",e)}})},update:function(e){$.ajax({url:app.url+"/"+e._id,data:e,method:"PUT",success:function(e){console.log("update baby",e)},error:function(e){console.error("dang son!",e)}})},deleteReview:function(e){var n=app.url.deletereview+"/:"+e;$.ajax({url:n,method:"DELETE",success:function(e){console.log("WE DELETED SOMETHING",e),app.readReview()},error:function(e){console.error("dang son!",e)}})},templater:function(e){return _.template(e)},htmlGen:function(e,n){var a=app.templater(e);return a(n)}};